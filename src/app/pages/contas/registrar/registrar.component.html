<!DOCTYPE html>
<html lang="pt-BR">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Página de Registro - Mãos que Curam</title>
	<link href="./registrar.component.css" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
</head>

<body>

	<div class="login-page">

		<!-- Imagem de fundo -->
		<div class="carousel-background">
			<img src="assets/img/fundo1.png" class="active" />
		</div>

		<!-- Fundo desfocado -->
		<div class="background"></div>

		<!-- Card de registro -->
		<div class="login-card">
			<img src="assets/img/logo.png" alt="Logo" class="logo" />
			<h1 class="title">Mãos que Curam</h1>
			<p class="subtitle">Preencha os dados para criar sua conta</p>

			<form [formGroup]="registrarForm" (ngSubmit)="onSubmit()">

				<div class="input-group">
					<i class="fas fa-user icon"></i>
					<input type="text" placeholder="Nome completo" formControlName="nome" required />
				</div>

				<div class="input-group">
					<i class="fas fa-envelope icon"></i>
					<input type="email" placeholder="E-mail" formControlName="email" required />
				</div>

				<div class="input-group">
					<i class="fas fa-phone icon"></i>
					<input type="tel" placeholder="(00)00000-0000" formControlName="numtel" id="telefone" maxlength="15"
						required />
				</div>

				<div class="input-group">
					<i class="fas fa-calendar icon"></i>
					<input type="date" formControlName="dataNascimento" required />
				</div>

				<div class="input-group">
					<i class="fas fa-lock icon"></i>
					<input type="password" placeholder="Senha" formControlName="senha" required />
				</div>

				<button type="submit" class="login-btn" [disabled]="registrarForm.invalid" id="registrarBtn">Registrar</button>
				<div *ngIf="successMessage" class="alert success">{{ successMessage }}</div>
				<div *ngIf="errorMessage" class="alert error">{{ errorMessage }}</div>

			</form>

			<p class="register-link">
				Já tem uma conta? <a [routerLink]="['/Logar']">Entre aqui</a>
			</p>
		</div>
	</div>

	<!-- SCRIPT para aplicar a máscara de telefone -->
	<script>
		const telefoneInput = document.getElementById('telefone');

		telefoneInput.addEventListener('input', function (e) {
			let value = e.target.value.replace(/\D/g, ''); // Remove tudo que não é número

			if (value.length > 11) {
				value = value.slice(0, 11); // Limita a 11 dígitos
			}

			// Formata para (00)00000-0000
			if (value.length > 0) {
				value = value.replace(/^(\d{2})(\d)/g, '($1)$2');
			}
			if (value.length > 9) {
				value = value.replace(/(\d{5})(\d{4})$/, '$1-$2');
			} else if (value.length > 6) {
				value = value.replace(/(\d{4})(\d{0,4})$/, '$1-$2');
			}

			e.target.value = value;
		});

		//  Novo script para confirmar criação e redirecionar
		const registrarBtn = document.getElementById('registrarBtn');
		if (registrarBtn) {
			registrarBtn.addEventListener('click', function (e) {
				e.preventDefault(); // evita envio imediato
				alert('Conta criada com sucesso!');
				window.location.href = '/logar'; // redireciona para a tela de login
			});
		}
	</script>
</body>

</html>
